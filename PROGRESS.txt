NHáº¬T KÃ Dá»° ÃN KHA-PARKING
NgÃ y khá»Ÿi táº¡o: 27/02/2026
CÃ´ng nghá»‡: Laravel 10+, SQL Server 2022 (PCIT\SQLEXPRESS)

1. Tá»”NG QUAN Há»† THá»NG
Há»‡ thá»‘ng quáº£n lÃ½ bÃ£i giá»¯ xe thÃ´ng minh: Kiá»ƒm soÃ¡t ra/vÃ o, nháº­n diá»‡n biá»ƒn sá»‘, quáº£n lÃ½ tháº» cÆ° dÃ¢n/vÃ£ng lai vÃ  tÃ­nh phÃ­ tá»± Ä‘á»™ng.

2. Cáº¤U TRÃšC CÆ  Sá» Dá»® LIá»†U (Database Schema)
- roles: PhÃ¢n quyá»n (IT, Manager, Accountant, Guard).
- users: TÃ i khoáº£n ngÆ°á»i dÃ¹ng (liÃªn káº¿t role_id).
- customers: ThÃ´ng tin chá»§ xe/cÆ° dÃ¢n.
- cards: Quáº£n lÃ½ tháº» RFID/QR (UID, loáº¡i tháº», tráº¡ng thÃ¡i, ngÃ y háº¿t háº¡n).
- vehicles: ThÃ´ng tin phÆ°Æ¡ng tiá»‡n (Biá»ƒn sá»‘, loáº¡i xe, mÃ u sáº¯c).
- gates: Quáº£n lÃ½ cá»•ng kiá»ƒm soÃ¡t (VÃ o/Ra, IP thiáº¿t bá»‹).
- pricing_rules: Cáº¥u hÃ¬nh giÃ¡ vÃ© (Theo loáº¡i xe, giá», qua Ä‘Ãªm).
- parking_transactions: Lá»‹ch sá»­ xe ra/vÃ o (Thá»i gian, hÃ¬nh áº£nh, biá»ƒn sá»‘, phÃ­, nhÃ¢n viÃªn trá»±c).

3. CÃC CÃ”NG VIá»†C ÄÃƒ THá»°C HIá»†N
- Khá»Ÿi táº¡o project Laravel táº¡i E:\Kha Service\KHA-PARKING.
- Thiáº¿t láº­p file .env káº¿t ná»‘i SQL Server (PCIT\SQLEXPRESS, database: kha_parking_db).
- Táº¡o vÃ  cáº­p nháº­t 8 file Migration Ä‘á»‹nh nghÄ©a cáº¥u trÃºc báº£ng.
- Táº¡o 8 Model (User, Role, Customer, Card, Vehicle, Gate, PricingRule, ParkingTransaction) vá»›i cÃ¡c má»‘i quan há»‡ (Relationships).
- Thiáº¿t láº­p DatabaseSeeder:
  + Táº¡o 4 quyá»n máº·c Ä‘á»‹nh.
  + Táº¡o Admin: admin@khaservice.vn / Admin@123.
  + Táº¡o báº£ng giÃ¡ máº«u cho Xe mÃ¡y (2k/h) vÃ  Ã” tÃ´ (10k/h).
  + Táº¡o Cá»•ng ChÃ­nh máº·c Ä‘á»‹nh.
- Thiáº¿t káº¿ giao diá»‡n (UI):
  + Layout chÃ­nh (layouts/app.blade.php): Sidebar hiá»‡n Ä‘áº¡i, Responsive Mobile.
  + Dashboard (index.blade.php): Thá»‘ng kÃª xe trong bÃ£i, lÆ°á»£t ra/vÃ o vÃ  giao dá»‹ch gáº§n Ä‘Ã¢y.
  + Cáº¥u hÃ¬nh Route trang chá»§.

4. HÆ¯á»šNG DáºªN THIáº¾T Láº¬P MÃ”I TRÆ¯á»œNG (SQL Server)
- CÃ i Ä‘áº·t PHP Driver cho SQL Server (php_sqlsrv_82_nts_x64.dll & php_pdo_sqlsrv_82_nts_x64.dll).
- Báº­t giao thá»©c TCP/IP trong SQL Server Configuration Manager (Port 1433).
- Báº­t dá»‹ch vá»¥ SQL Server Browser.
- Táº¡o database "original_kha_parking_db" trong SSMS.

BÆ¯á»šC 1 â€” Má»Ÿ CMD quyá»n Administrator (Báº®T BUá»˜C)

Start Menu â†’ gÃµ:

cmd

ğŸ‘‰ Right click â†’ Run as administrator

Náº¿u khÃ´ng cháº¡y admin â†’ lá»‡nh reg add sáº½ FAIL.

âœ… BÆ¯á»šC 2 â€” Báº­t TCP/IP báº±ng CMD (chuáº©n cho SQL Server 2022)

Copy cháº¡y tá»«ng dÃ²ng:

ğŸ”¥ Enable TCP/IP
reg add "HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQL16.SQLEXPRESS\MSSQLServer\SuperSocketNetLib\Tcp" /v Enabled /t REG_DWORD /d 1 /f
ğŸ”¥ Set port cá»‘ Ä‘á»‹nh 1433 (táº¯t dynamic port)
reg add "HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQL16.SQLEXPRESS\MSSQLServer\SuperSocketNetLib\Tcp\IPAll" /v TcpPort /t REG_SZ /d 1433 /f
reg add "HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQL16.SQLEXPRESS\MSSQLServer\SuperSocketNetLib\Tcp\IPAll" /v TcpDynamicPorts /t REG_SZ /d "" /f

ğŸ‘‰ DÃ²ng nÃ y cá»±c quan trá»ng â€” náº¿u khÃ´ng SQL Express váº«n dÃ¹ng port random.

âœ… BÆ¯á»šC 3 â€” Restart SQL Server service

VÃ¬ báº¡n dÃ¹ng SQLEXPRESS nÃªn service name lÃ :

MSSQL$SQLEXPRESS

Cháº¡y:

net stop MSSQL$SQLEXPRESS
net start MSSQL$SQLEXPRESS

Náº¿u tháº¥y:

The SQL Server (SQLEXPRESS) service was started successfully.

ğŸ‘‰ OK.

âœ… BÆ¯á»šC 4 â€” Má»Ÿ Firewall port 1433
netsh advfirewall firewall add rule name="SQL Server 1433" dir=in action=allow protocol=TCP localport=1433
âœ… BÆ¯á»šC 5 â€” Kiá»ƒm tra SQL Server Ä‘Ã£ nghe port chÆ°a (QUAN TRá»ŒNG)

Cháº¡y:

netstat -ano | findstr 1433

Náº¿u Ä‘Ãºng sáº½ tháº¥y:

LISTENING    0.0.0.0:1433

ğŸ‘‰ nghÄ©a lÃ  SQL Server Ä‘Ã£ má»Ÿ TCP thÃ nh cÃ´ng.

âœ… BÆ¯á»šC 6 â€” Test káº¿t ná»‘i tháº­t
sqlcmd -S 127.0.0.1,1433 -E

Náº¿u vÃ o Ä‘Æ°á»£c:

1>

=> SQL Server OK 100%.

Call to undefined function Illuminate\Encryption\openssl_cipher_iv_length()
â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„
âœ¦ Lá»—i nÃ y xuáº¥t phÃ¡t tá»« viá»‡c extension `openssl` chÆ°a Ä‘Æ°á»£c báº­t trong cáº¥u hÃ¬nh PHP cá»§a báº¡n. Laravel yÃªu cáº§u extension nÃ y
  Ä‘á»ƒ mÃ£ hÃ³a (encryption) vÃ  xá»­ lÃ½ cÃ¡c khÃ³a báº£o máº­t.

  Äá»ƒ kháº¯c phá»¥c, báº¡n hÃ£y lÃ m theo cÃ¡c bÆ°á»›c sau:

  1. Kiá»ƒm tra vá»‹ trÃ­ file php.ini
  Cháº¡y lá»‡nh sau Ä‘á»ƒ biáº¿t PHP Ä‘ang dÃ¹ng file cáº¥u hÃ¬nh nÃ o:


   1 php --ini
  TÃ¬m dÃ²ng Loaded Configuration File. ThÃ´ng thÆ°á»ng nÃ³ náº±m á»Ÿ: C:\php\php.ini hoáº·c trong thÆ° má»¥c XAMPP/WAMP cá»§a báº¡n.


  2. Báº­t extension OpenSSL
   1. Má»Ÿ file php.ini báº±ng Notepad hoáº·c VS Code.
   2. TÃ¬m dÃ²ng: ;extension=openssl (hoáº·c ;extension=php_openssl.dll trÃªn cÃ¡c báº£n cÅ©).
   3. XÃ³a dáº¥u cháº¥m pháº©y (`;`) á»Ÿ Ä‘áº§u dÃ²ng Ä‘á»ƒ nÃ³ trá»Ÿ thÃ nh:


   1    extension=openssl
   4. TÃ¬m thÃªm dÃ²ng extension_dir = "ext" (hoáº·c Ä‘Æ°á»ng dáº«n tuyá»‡t Ä‘á»‘i Ä‘áº¿n thÆ° má»¥c ext) vÃ  Ä‘áº£m báº£o nÃ³ khÃ´ng bá»‹ comment Ä‘á»ƒ
      PHP biáº¿t chá»— tÃ¬m file extension.


  3. Kiá»ƒm tra láº¡i
  Sau khi lÆ°u file php.ini, hÃ£y cháº¡y lá»‡nh nÃ y Ä‘á»ƒ xÃ¡c nháº­n openssl Ä‘Ã£ Ä‘Æ°á»£c báº­t:
   1 php -m | findstr openssl
  Náº¿u hiá»‡n ra chá»¯ openssl lÃ  thÃ nh cÃ´ng.

Tham kháº£o cáº¥u hÃ¬nh php.ini
;extension=curl
;extension=ffi
;extension=ftp
;extension=fileinfo
;extension=gd
;extension=gettext
;extension=gmp
;extension=intl
;extension=imap
;extension=mbstring
;extension=exif      ; Must be after mbstring as it depends on it
;extension=mysqli
;extension=oci8_12c  ; Use with Oracle Database 12c Instant Client
;extension=oci8_19  ; Use with Oracle Database 19 Instant Client
;extension=odbc
extension=openssl
;extension=pdo_firebird
;extension=pdo_mysql
;extension=pdo_oci
;extension=pdo_odbc
;extension=pdo_pgsql
;extension=pdo_sqlite
;extension=pgsql
;extension=shmop
extension=php_sqlsrv_82_nts_x64.dll
extension=php_pdo_sqlsrv_82_nts_x64.dll

5. Lá»†NH Váº¬N HÃ€NH
- Khá»Ÿi táº¡o dá»¯ liá»‡u: php artisan migrate --seed
- Cháº¡y web: php artisan serve
- Truy cáº­p: http://127.0.0.1:8000
